{% extends 'home_base.html' %}
{% load staticfiles %}
{% block title %} Product {% endblock %}
{% block context %}

<div class="row" style="margin-bottom: 15px;margin-top: 2px;">
	<div class="col-xs-12  col-sm-12"> 
	<p class="icon-laptop" style="float: left; font-size: 40px; margin-right: 5px;"></p>
	<p style="font-size: 30px; color:blue;"> 
	{{ProductModelobj.product_model}}
	</p>
	</div>
</div>  
<div class="row ">
	<div class="col-xs-12  col-sm-12">
		<!-- Nav tabs -->
		<ul class="nav nav-tabs mynav" role="tablist">
			<li role="presentation" class="active" style="font-size: 20px;" ><a value="basic" href="#basic" aria-controls="home" role="tab" data-toggle="tab">基本信息</a></li>
			<li role="presentation" style="font-size: 20px;" ><a  value="databody" href="#databody" aria-controls="profile" role="tab" data-toggle="tab">数据点</a></li>
			<li role="presentation" style="font-size: 20px;" ><a value="updata"  href="#updata" aria-controls="messages" role="tab" data-toggle="tab">上行数据体</a></li>
			<li role="presentation" style="font-size: 20px;" ><a value="downdata" href="#downdata" aria-controls="settings" role="tab" data-toggle="tab">下行数据体</a></li>
		</ul>
		<!-- Tab panes -->
		<div class="tab-content">
			<div role="tabpanel" class="tab-pane active" id="basic" style="background-color: #C0C0C0;">    
				<dl style="font-size: 17px; margin:20px 20px;">
					<br>
					<dt>模型名字：</dt>
					<br>
					<dd id='model_name'>{{ProductModelobj.product_model}}</dd>
					<br>
					<dt>模型描述：</dt>
					<br>
					<dd>{{ProductModelobj.product_desc}}</dd>
					<br>
					<dt>创建时间：</dt>
					<br>
					<dd>{{ProductModelobj.create_time}}</dd>
					<br>
					<dt>更新时间：</dt>
					<br>
					<dd>{{ProductModelobj.current_time}}</dd>
					<br>
					<dt>用户：</dt>
					<br>
					<dd>{{ProductModelobj.user}}</dd>
					<br>
				</dl>   
			</div>
			<div role="tabpanel" class="tab-pane" id="databody">
				<div class="row mymodal" style="margin-bottom: 30px;margin-left: 10px; margin-top: 30px;">
					<button id="add_data " type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" style="font-size: 20px;float: left;background-color:#F0FFFF;color:#000000;border-radius: 30px;outline:none;">新增数据体</button>

					<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
					  <div class="modal-dialog" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								<h4 class="modal-title" id="exampleModalLabel">数据体</h4>
							</div>
							<div class="modal-body">
								<form>
                                    {% csrf_token %}  
									<div class="row">
										<div class="col-sm-3 col-sm-offset-1"> 
										<label  style="font-size:16px;padding:5px;text-align:right;">数据点名称</label>
										</div>
										<div class="col-sm-6">
											<input type="text" class="form-control add_data modalpointname"  placeholder="sensor_1" id="data_point_name" required='required' >
										</div>
									</div>
                                    <div class="row">
										<div class="col-sm-3 col-sm-offset-1 "> 
                                        <label  style="font-size:16px;padding:5px;">显示名称</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class="form-control add_data modalshowname"  placeholder="传感器_1"  id="data_point_showname" required='required'>
                                        </div>
                                    </div>
                                    <div class="row">
										<div class="col-sm-3 col-sm-offset-1 "> 
                                        <label  style="font-size:16px;padding:5px;">TLVType</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class="form-control add_data modeltlvtype"  placeholder="0-255之间的数字" id="TLVType" required='required'>
                                        </div>
                                    </div> 
                                    <div class="row">
										<div class="col-sm-3 col-sm-offset-1 "> 
                                        <label  style="font-size:16px;padding:5px;">读写类型</label>
                                        </div>
                                        <div class="col-sm-6">
											<select class="form-control" id="Opteron_type">
												<option>只读</option>
												<option>读写</option>
											</select>
                                        </div>
                                    </div>
                                    <div class="row">
										<div class="col-sm-3 col-sm-offset-1 "> 
                                            <label  style="font-size:16px;padding:5px;">数据类型</label>
                                        </div>
                                        <div class="col-sm-6">
											<select class="form-control" id="DataType">
												<option>Char(-2^7-1 ~ 2^7,1字节)</option>
                                                <option>uChar(0 ~ 2^8,1字节)</option>
												<option>Short(-2^15-1 ~ 2^15,2字节)</option>
                                                <option>uShort(0 ~ 2^16,2字节)</option>						
                                                <option>Int(-2^31-1~ 2^31,4字节)</option>
                                                <option>uInt(0 ~ 2^32,4字节)</option>
												<option>Long Long(-2^63-1 ~ 2^63,8字节)</option>
                                                <option>uLong Long(0 ~ 2^64,8字节)</option>
												<option>Float(-3.40282^-38 ~ 3.40282^38,4字节)</option>
												<option>Double(-1.79769^-308 ~ 1.79769^308,8字节)</option>
												<option>Bool(布尔,单字节)</option>
												<option>Enum(枚举,单字节)</option>
												<option>String(十六进制)</option>
												<option>String(UTF-8编码)</option>
											</select>
                                        </div>
                                    </div>
                                    <div class="row" >
                                        <div id='template_1'>                           
                                            <div class="col-xs-12 col-sm-3 col-sm-offset-1 "> 
                                                    <label  style="font-size:16px;padding:5px;">数据定义</label>
                                            </div>
                                            <div class="col-sm-6 ">
                                                <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1" >
                                                        <label>最小值</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>最大值</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>步进值</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                    <div class="row">
                                                        <div class="col-xs-4 col-sm-4 " >
                                                            <input type="text" class="form-control template_1"    id="int_min_value">
                                                        </div>
                                                        <div class="col-xs-4 col-sm-4 ">
                                                            <input type="text" class="form-control template_1 " id="int_max_value" >
                                                        </div>
                                                        <div class="col-xs-4 col-sm-4 ">
                                                           <input type="text" class="form-control template_1"
                                                            id="step_value" >
                                                        </div>
                                                    </div>
                                            </div>
                                             <div class="col-sm-3 col-sm-offset-1 "> 
                                                <label  style="font-size:16px;padding:5px;">数据单位</label>
                                             </div>
                                             <div class="col-sm-6 ">
                                                <input type="text" class="form-control add_data " id="unit">
                                             </div>
                                        </div>   
                                    </div>
                                    <div class="row" id="template_2" style="display:none;">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                            <label  style="font-size:16px;padding:5px;">最大长度</label>
                                        </div>
                                        <div class="col-sm-6 ">
                                                <input type="text" class="form-control add_data "  placeholder="0-65535个字符串" id="str_maxlen">
                                        </div>
                                    </div> 
                                    <div class="row" id="template_3" style="display:none;">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                            <label  style="font-size:16px;padding:5px;">数据定义</label>
                                        </div>
                                        <div class="col-sm-6 ">
                                                 <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>值名称</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>显示名称</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>值内容</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="true_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="true_show_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" value="1" class="form-control add_data" readonly="readonly" id="bool_true"> 
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="false_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="false_show_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text"  value="0" class="form-control add_data" readonly="readonly"
                                                            id="bool_false"> 
                                                    </div>
                                                </div>
                                        </div>
                                    </div>        
                                    <div class="row" style="margin-top: 10px;">
                                        <div class="col-xs-1 col-xs-offset-4  col-sm-1 col-sm-offset-4">
                                            <button type="button" class="btn btn-default" data-dismiss="modal"  style="padding-left: 20px;padding-right: 20px;">取消</button>
                                        </div>  
                                        <div class="col-xs-1 col-xs-offset-1 col-sm-1 col-sm-offset-2">                      
                                            <button type="submit" class="btn btn-primary" style="padding-left:20px;padding-right: 20px;margin-left: 40px;" id="data_point_save">保存</button>
                                        </div>
                                    </div>      
								</form> 							                 
							</div>
						  </div>
						</div>
					</div>
                    <div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
                      <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="exampleModalLabel">数据体</h4>
                            </div>
                            <div class="modal-body">
                                <form>
                                    {% csrf_token %}  
                                    <div class="row">
                                        <div class="col-sm-3 col-sm-offset-1"> 
                                        <label  style="font-size:16px;padding:5px;text-align:right;">数据点名称</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class=" form-control add_data modal2pointname" disabled="disabled"  placeholder="sensor_1" id="data_point_name" required='required' >
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                        <label  style="font-size:16px;padding:5px;">显示名称</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class=" form-control add_data modal2showname"  placeholder="传感器_1"  id="data_point_showname" required='required'>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                        <label  style="font-size:16px;padding:5px;">TLVType</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class=" form-control add_data model2tlvtype"  placeholder="0-255之间的数字" id="TLVType" required='required'>
                                        </div>
                                    </div> 
                                    <div class="row">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                        <label  style="font-size:16px;padding:5px;">读写类型</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <select class="form-control" id="Opteron_type">
                                                <option>只读</option>
                                                <option>读写</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                            <label  style="font-size:16px;padding:5px;">数据类型</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <select class="form-control" id="DataType2">
                                                <option>Char(-2^7-1 ~ 2^7,1字节)</option>
                                                <option>uChar(0 ~ 2^8,1字节)</option>
                                                <option>Short(-2^15-1 ~ 2^15,2字节)</option>
                                                <option>uShort(0 ~ 2^16,2字节)</option>                       
                                                <option>Int(-2^31-1~ 2^31,4字节)</option>
                                                <option>uInt(0 ~ 2^32,4字节)</option>
                                                <option>Long Long(-2^63-1 ~ 2^63,8字节)</option>
                                                <option>uLong Long(0 ~ 2^64,8字节)</option>
                                                <option>Float(-3.40282^-38 ~ 3.40282^38,4字节)</option>
                                                <option>Double(-1.79769^-308 ~ 1.79769^308,8字节)</option>
                                                <option>Bool(布尔,单字节)</option>
                                                <option>Enum(枚举,单字节)</option>
                                                <option>String(十六进制)</option>
                                                <option>String(UTF-8编码)</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row" >
                                        <div id='template_1'>                           
                                            <div class="col-xs-12 col-sm-3 col-sm-offset-1 "> 
                                                    <label  style="font-size:16px;padding:5px;">数据定义</label>
                                            </div>
                                            <div class="col-sm-6 ">
                                                <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1" >
                                                        <label>最小值</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>最大值</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>步进值</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                    <div class="row">
                                                        <div class="col-xs-4 col-sm-4 " >
                                                            <input type="text" class="form-control template_1"   id="int_min_value">
                                                        </div>
                                                        <div class="col-xs-4 col-sm-4 ">
                                                            <input type="text" class="form-control template_1 " id="int_max_value" >
                                                        </div>
                                                        <div class="col-xs-4 col-sm-4 ">
                                                           <input type="text" class="form-control template_1"   id="step_value" >
                                                        </div>
                                                    </div>
                                            </div>
                                             <div class="col-sm-3 col-sm-offset-1 "> 
                                                <label  style="font-size:16px;padding:5px;">数据单位</label>
                                             </div>
                                             <div class="col-sm-6 ">
                                                <input type="text" class="form-control add_data " id="unit">
                                             </div>
                                        </div>   
                                    </div>
                                    <div class="row" id="template_2" style="display:none;">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                            <label  style="font-size:16px;padding:5px;">最大长度</label>
                                        </div>
                                        <div class="col-sm-6 ">
                                        <input type="text" class="form-control add_data" placeholder="0-65535个字符串" id="str_maxlen">
                                        </div>
                                    </div> 
                                    <div class="row" id="template_3" style="display:none;">
                                        <div class="col-sm-3 col-sm-offset-1 "> 
                                            <label  style="font-size:16px;padding:5px;">数据定义</label>
                                        </div>
                                        <div class="col-sm-6 ">
                                                 <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>值名称</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>显示名称</label>
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                        <label>值内容</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="true_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="true_show_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" value="1" class="form-control add_data" readonly="readonly" id="bool_true"> 
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="false_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text" name="" class="form-control add_data" id="false_show_name"> 
                                                    </div>
                                                    <div class="col-xs-4 col-sm-4 template_1">
                                                            <input type="text"  value="0" class="form-control add_data" readonly="readonly"
                                                            id="bool_false"> 
                                                    </div>
                                                </div>
                                        </div>
                                    </div>        
                                    <div class="row" style="margin-top: 10px;">
                                        <div class="col-xs-1 col-xs-offset-4  col-sm-1 col-sm-offset-4">
                                            <button type="button" class="btn btn-default" data-dismiss="modal"  style="padding-left: 20px;padding-right: 20px;">取消</button>
                                        </div>  
                                        <div class="col-xs-1 col-xs-offset-1 col-sm-1 col-sm-offset-2">                      
                                            <button type="submit" class="btn btn-primary" style="padding-left:20px;padding-right: 20px;margin-left: 40px;" id="data_point_save">保存</button>
                                        </div>
                                    </div>      
                                </form>                                              
                            </div>
                          </div>
                        </div>
                    </div>
				</div>
                <div class="row DataPointShow" id={{ProductModelobj.product_model}}>
                {% if ExistsedPointlist %}
                    {% for ExistsedPoint in ExistsedPointlist %}
                        {% if ExistsedPoint.data_type == 'Char' or ExistsedPoint.data_type  ==  "UChar" or ExistsedPoint.data_type  == 'Short'  or ExistsedPoint.data_type  == 'UShort' or ExistsedPoint.data_type ==  'Int' or ExistsedPoint.data_type  ==  'UInt' or  ExistsedPoint.data_type  ==  'Long Long' or  ExistsedPoint.data_type  ==  'ULong Long' or  ExistsedPoint.data_type  ==  'Float' or  ExistsedPoint.data_type  ==  'Double' %}
                            <div class='col-xs-12 col-sm-12 point' id="modal_{{ExistsedPoint.id}}" data-name="{{ExistsedPoint}}">
                                    <table class="table" >
                                        <tr>
                                            <td class='col-xs-3  col-sm-3' >
                                                <p class='showname' style="float: left; " id={{ExistsedPoint.show_name}}>数据点：{{ExistsedPoint.show_name}}</p> 
                                            </td>
                                            <td></td>
                                            <td></td>
                                            <td class='col-xs-3 col-sm-3'>
                                                <form style="float: right;">
                                                    <button type="submit" id='Edit_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default Edit_point_{{ExistsedPoint.id}}" data-point="modal_{{ExistsedPoint.id}}">
                                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                                    </button>
                                                    <button type="submit" id='del_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default" >
                                                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 pointname' id={{ExistsedPoint.data_name}}>
                                            名称:{{ExistsedPoint.data_name}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 tlvtype' id={{ExistsedPoint.TLV_Type}}>
                                             TLVType:{{ExistsedPoint.TLV_Type}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 operation' id="{{ExistsedPoint.operation_type}}">
                                             操作类型:{{ExistsedPoint.operation_type}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 datatype' id="{{ExistsedPoint.data_type}}">
                                             数据类型:{{ExistsedPoint.data_type}}
                                            </td>
                                        </tr>   
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 minvalue' id="{{ExistsedPoint.min_value}}">
                                            最小值:{{ExistsedPoint.min_value}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 maxvalue' id="{{ExistsedPoint.max_value}}">
                                            最大值:{{ExistsedPoint.max_value}}    
                                            </td>
                                            <td class='col-xs-3  col-sm-3 stepbystep' id="{{ExistsedPoint.step_by_step}}  ">
                                            步进值:{{ExistsedPoint.step_by_step}}   
                                            </td>
                                            <td class='col-xs-3  col-sm-3 valueunit' id="{{ExistsedPoint.value_unit}}">
                                            单位:{{ExistsedPoint.value_unit}}
                                            </td>
                                        </tr>           
                                    </table>
                            </div>
                        {% elif ExistsedPoint.data_type == 'Bool' %}
                             <div class='col-xs-12  col-sm-12 point' id="modal_{{ExistsedPoint.id}}">
                                    <table class="table" >
                                        <tr>
                                            <td class='col-xs-3  col-sm-3' >
                                                <p class='showname' style="float: left; " id={{ExistsedPoint.show_name}}>数据点：{{ExistsedPoint.show_name}}</p> 
                                            </td>
                                            <td></td>
                                            <td></td>
                                            <td class='col-xs-3 col-sm-3'>
                                                <form style="float: right;">
                                                    <button type="submit" id='Edit_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default Edit_point_{{ExistsedPoint.id}}" data-point="modal_{{ExistsedPoint.id}}">
                                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                                    </button>
                                                    <button type="submit" id='del_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default" >
                                                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 pointname' id={{ExistsedPoint.data_name}}>
                                            名称:{{ExistsedPoint.data_name}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 tlvtype' id={{ExistsedPoint.TLV_Type}}>
                                             TLVType:{{ExistsedPoint.TLV_Type}}
                                            </td>
                                            <td class='col-xs-3 col-sm-3 operation' id="{{ExistsedPoint.operation_type}}">
                                             操作类型:{{ExistsedPoint.operation_type}}
                                            </td>
                                            <td class='col-xs-3 col-sm-3 datatype' id="{{ExistsedPoint.data_type}}" >
                                             数据类型:{{ExistsedPoint.data_type}}
                                            </td>
                                        </tr>   
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 truevalue'  data-trueshowname="{{ExistsedPoint.true_value_show}}"  data-truevaluename="{{ExistsedPoint.true_value_name}}"  data-truevalue="{{ExistsedPoint.true_bool_value}}">
                                            {{ExistsedPoint.true_value_show}}:{{ExistsedPoint.true_value_name}}-{{ExistsedPoint.true_bool_value}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 falsevalue'
                                            data-falseshowname="{{ExistsedPoint.false_value_show}}" 
                                            data-falsevaluename="{{ExistsedPoint.false_value_name}}" 
                                            data-falsevalue="{{ExistsedPoint.false_bool_value}}">
                                            {{ExistsedPoint.false_value_show}}:{{ExistsedPoint.false_value_name}}-{{ExistsedPoint.false_bool_value}}  
                                            </td>
                                            <td></td>
                                            <td></td>
                                        </tr>           
                                    </table>
                            </div>
                        {% elif ExistsedPoint.data_type == 'Enum' %}
                            <div class='col-xs-12  col-sm-12 point' id="modal_{{ExistsedPoint.id}}">
                                    <table class="table" >
                                        <tr>
                                            <td class='col-xs-3  col-sm-3' >
                                                <p class='showname' style="float: left; " id={{ExistsedPoint.show_name}}>数据点：{{ExistsedPoint.show_name}}</p> 
                                            </td>
                                            <td></td>
                                            <td></td>
                                            <td class='col-xs-3 col-sm-3'>
                                                <form style="float: right;">
                                                    <button type="submit" id='Edit_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default Edit_point_{{ExistsedPoint.id}}" data-point="modal_{{ExistsedPoint.id}}">
                                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                                    </button>
                                                    <button type="submit" id='del_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default" >
                                                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 pointname' id={{ExistsedPoint.data_name}}>
                                            名称:{{ExistsedPoint.data_name}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 tlvtype' id={{ExistsedPoint.TLV_Type}}>
                                             TLVType:{{ExistsedPoint.TLV_Type}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3' >
                                             操作类型:{{ExistsedPoint.operation_type}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3' >
                                             数据类型:{{ExistsedPoint.data_type}}
                                            </td>
                                        </tr>   
                                        <tr>
                                            <td class='col-xs-3  col-sm-3'>
                                            最小值:{{ExistsedPoint.min_value}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3'>
                                            最大值:{{ExistsedPoint.max_value}}    
                                            </td>
                                            <td class='col-xs-3  col-sm-3'>
                                            步进值:{{ExistsedPoint.step_by_step}}   
                                            </td>
                                            <td class='col-xs-3  col-sm-3'>
                                            单位:{{ExistsedPoint.value_unit}}
                                            </td>
                                        </tr>           
                                    </table>
                            </div>
                        {% else %}
                            <div class='col-xs-12  col-sm-12 point' id="modal_{{ExistsedPoint.id}}">
                                    <table class="table" >
                                        <tr>
                                            <td class='col-xs-3  col-sm-3' >
                                                <p class='showname' style="float: left; " id={{ExistsedPoint.show_name}}>数据点：{{ExistsedPoint.show_name}}</p> 
                                            </td>
                                            <td></td>
                                            <td></td>
                                            <td class='col-xs-3 col-sm-3'>
                                                <form style="float: right;">
                                                    <button type="submit" id="Edit_point" value="{{ExistsedPoint.data_name}}"  class="btn btn-default Edit_point_{{ExistsedPoint.id}}" data-point="modal_{{ExistsedPoint.id}}">
                                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                                    </button>
                                                    <button type="submit" id='del_point' value="{{ExistsedPoint.data_name}}"  class="btn btn-default" >
                                                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 pointname' id={{ExistsedPoint.data_name}}>
                                            名称:{{ExistsedPoint.data_name}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3 tlvtype' id={{ExistsedPoint.TLV_Type}}>
                                             TLVType:{{ExistsedPoint.TLV_Type}}
                                            </td>
                                            <td class='col-xs-3 col-sm-3 operation' id="{{ExistsedPoint.operation_type}}">
                                             操作类型:{{ExistsedPoint.operation_type}}
                                            </td>
                                            <td class='col-xs-3 col-sm-3 datatype' id="{{ExistsedPoint.data_type}}">
                                             数据类型:{{ExistsedPoint.data_type}}
                                            </td>
                                        </tr>   
                                        <tr>
                                            <td class='col-xs-3  col-sm-3 strmaxlen' id="{{ExistsedPoint.str_maxlen}}">
                                            字段串长度:{{ExistsedPoint.str_maxlen}}
                                            </td>
                                            <td class='col-xs-3  col-sm-3'>
                                          
                                            </td>
                                            <td class='col-xs-3  col-sm-3'>
                                            
                                            </td>
                                            <td class='col-xs-3  col-sm-3'>
                                           
                                            </td>
                                        </tr>           
                                    </table>
                            </div>                            
                        {% endif %}
                    {% endfor %}
                {% endif %}      
                </div>
			</div>
			<div role="tabpanel" class="tab-pane" id="updata">
                {% include "product_development_specific_updata.html" with upstreamlist=upstreamlist ExistsedPointlist=ExistsedPointlist upstream_datapointlist=upstream_datapointlist %}
            </div>
			<div role="tabpanel" class="tab-pane" id="downdata">
                {% include "product_development_specific_downdata.html" with downstreamlist=downstreamlist ExistsedPointlist=ExistsedPointlist downstream_datapointlist=downstream_datapointlist%}         
            </div>
		</div>
    </div>
</div>
<script type="text/javascript">

	$(function(){ 
        //var value = new Boolean;
        //获取uri
		$('.mynav li a').click(function(){
            model_name = $('#model_name').text();
			data_pointobj.model_select_uri = $(this).attr('value')+'/';
		});
        //数据类型下拉表单改变触发事件
		$("#DataType").change(function(){ //下拉表单选择触发事件
			var option = new String;
			option=$("#DataType").val();
			console.log(option);
			if (option=="Char(-2^7-1 ~ 2^7,1字节)"||option=="uChar(0 ~ 2^8,1字节)" || option=="Short(-2^15-1 ~ 2^15,2字节)"|| option =="uShort(0 ~ 2^16,2字节)" ||option=="Int(-2^31-1~ 2^31,4字节)" || option=="uInt(0 ~ 2^32,4字节)"|| option=="Long Long(-2^63-1 ~ 2^63,8字节)" || option=="uLong Long(0 ~ 2^64,8字节)"||option=="Float(-3.40282^-38 ~ 3.40282^38,4字节)"||option=="Double(-1.79769^-308 ~ 1.79769^308,8字节)"){
				$('#template_1').attr('style', "display:block");
                $('#template_2').attr('style', "display:none");
                $('#template_3').attr('style', "display:none");
                $("#DataType").attr('name','number');
			}
			else if (option=="String(十六进制)"|| option=="String(UTF-8编码)"){
                $('#template_1').attr('style', "display:none");
                $('#template_2').attr('style', "display:block");
                $('#template_3').attr('style', "display:none");
                $("#DataType").attr('name','str');
			}
            else if (option=="Bool(布尔,单字节)")
            {
                $('#template_1').attr('style', "display:none");
                $('#template_2').attr('style', "display:none");
                $('#template_3').attr('style', "display:block");
                $("#DataType").attr('name','bool');
            }
            else
            {
                //Enum(枚举，单字节)
            }
		});	
        $("#exampleModal2 #DataType2").change(function(){ //下拉表单选择触发事件
            var option = new String;
            option=$("#exampleModal2 #DataType2").val();
            console.log(option);
            if (option=="Char(-2^7-1 ~ 2^7,1字节)"||option=="uChar(0 ~ 2^8,1字节)" || option=="Short(-2^15-1 ~ 2^15,2字节)"|| option =="uShort(0 ~ 2^16,2字节)" ||option=="Int(-2^31-1~ 2^31,4字节)" || option=="uInt(0 ~ 2^32,4字节)"|| option=="Long Long(-2^63-1 ~ 2^63,8字节)" || option=="uLong Long(0 ~ 2^64,8字节)"||option=="Float(-3.40282^-38 ~ 3.40282^38,4字节)"||option=="Double(-1.79769^-308 ~ 1.79769^308,8字节)"){
                $('#exampleModal2 #template_1').attr('style', "display:block");
                $('#exampleModal2 #template_2').attr('style', "display:none");
                $('#exampleModal2 #template_3').attr('style', "display:none");
                $("#exampleModal2 #DataType2").attr('name','number');
            }
            else if (option=="String(十六进制)"|| option=="String(UTF-8编码)"){
                $('#exampleModal2 #template_1').attr('style', "display:none");
                $('#exampleModal2 #template_2').attr('style', "display:block");
                $('#exampleModal2 #template_3').attr('style', "display:none");
                $("#exampleModal2 #DataType2").attr('name','str');
            }
            else if (option=="Bool(布尔,单字节)")
            {
                $('#exampleModal2 #template_1').attr('style', "display:none");
                $('#exampleModal2 #template_2').attr('style', "display:none");
                $('#exampleModal2 #template_3').attr('style', "display:block");
                $("#exampleModal2 #DataType2").attr('name','bool');
            }
            else
            {
                //Enum(枚举，单字节)
            }
        });
        //保存数据点
        $('#data_point_save').click(function(){
            data_pointobj.data_name = $('#data_point_name').val();
            data_pointobj.show_name = $('#data_point_showname').val();
            data_pointobj.TLV_Type  = $('#TLVType').val();
            data_pointobj.operation_type = $('#Opteron_type').val();
            data_pointobj.data_type  = $("#DataType").val(); 
            if ($('#DataType').attr('name') == 'number' || data_pointobj.data_type == "Char(-2^7-1 ~ 2^7,1字节)")
            {
                data_pointobj.max_value = $('#int_max_value').val();
                data_pointobj.min_value = $('#int_min_value').val();
                data_pointobj.step_by_step = $('#step_value').val();
                data_pointobj.value_unit = $('#unit').val();
            }
            else if ($('#DataType').attr('name') == 'str')
            {
                data_pointobj.str_maxlen = $('#str_maxlen').val();
            }
            else if ($('#DataType').attr('name') == 'bool')
            {
                data_pointobj.true_value_name = $('#true_name').val();
                data_pointobj.true_value_show = $('#true_show_name').val();
                data_pointobj.true_bool_value = 1;
                data_pointobj.false_value_name = $('#false_name').val();
                data_pointobj.false_value_show = $('#false_show_name').val();
                data_pointobj.false_bool_value = 0;
            }  
            var revalue= Get_DataPointattr(model_name,data_pointobj.data_name,data_pointobj.show_name,data_pointobj.TLV_Type);    
            if (revalue=='PointName')
            {
                addmyalert('数据点名称已被使用','form-control add_data modalpointname'); 
                $('.modalpointname').popover('show');
                return false;
            }
            else if (revalue=='showname')
            {
                $('.modalpointname').popover('hide');
                addmyalert('显示名称已被使用','form-control add_data modalshowname');
                $('.modalshowname').popover('show'); 
                return false; 
            }
            else if (revalue=='tlvtype')
            {
                $('.modalshowname').popover('hide');
                addmyalert('TVLType值已被使用','form-control add_data modeltlvtype'); 
                $('.modeltlvtype').popover('show');
                return false;               
            }
            else
            {    
                $('.modeltlvtype').popover('hide');    
                $.ajax({
                    url:"../../product_development_specific/"+model_name+'/'+data_pointobj.model_select_uri,
                    type:"POST",
                    timeout:5000,
                    contextType:"application/json;charset=utf-8",
                    data:JSON.stringify(data_pointobj),//data 为字典格式
                    dataType:"json",
                    async:true,
                    headers:{"X-CSRFToken":$('[name="csrfmiddlewaretoken"]').val()},
                    success:function(arg){
                        console.log(arg);
                        if(arg['success']=='success')
                        {
                            alert('success');

                        }
                        window.location.href=".";
                    },
                    error:function(XMLHttpRequest,textStatus,errorThrown){
                        console.log(textStatus);
                    },
                }); 
                return false;  
            } 
        });
        //删除数据点
        $('.point #del_point').click(function(){
            var myDataPointObj = {
                Operation_type:'del',
                datapoint_name:$(this).attr('value'),
            }
            if (alert_cancel('确定删除 '+myDataPointObj.datapoint_name+' 数据点吗？'))
            {
                $.ajax({
                        url:"../../product_development_specific/"+model_name+'/'+data_pointobj.model_select_uri,
                        type:"POST",
                        timeout:5000,
                        contextType:"application/json;charset=utf-8",
                        data:JSON.stringify(myDataPointObj),//data 为字典格式
                        dataType:"json",
                        async:true,
                        headers:{"X-CSRFToken":$('[name="csrfmiddlewaretoken"]').val()},
                        success:function(arg){
                            console.log(arg);
                            window.location.href="."
                        },
                        error:function(XMLHttpRequest,textStatus,errorThrown){
                            console.log(textStatus);
                        },
                });
            }
            else
            {
                return false //终止默认alter跳转处理
            }
        });
        //修改数据点
        $('.point #Edit_point').click(function(){
            var this_id = $(this).attr('data-point');
            updatemodal(this_id);
            return false;
        });
        //保存修改的数据点
        $('#exampleModal2 #data_point_save').click(function(){
            data_pointobj.Operation_type = 'updatesave';
            data_pointobj.data_name = $('#exampleModal2 #data_point_name').val();
            data_pointobj.show_name = $('#exampleModal2 #data_point_showname').val();
            data_pointobj.TLV_Type  = $('#exampleModal2 #TLVType').val();
            data_pointobj.operation_type = $('#exampleModal2 #Opteron_type').val();
            data_pointobj.data_type  = $("#exampleModal2 #DataType2").val();
            if ($('#exampleModal2 #DataType2').attr('name') == 'number' || data_pointobj.data_type == "Char(-2^7-1 ~ 2^7,1字节)")
            {
                data_pointobj.max_value = $('#exampleModal2 #int_max_value').val();
                data_pointobj.min_value = $('#exampleModal2 #int_min_value').val();
                data_pointobj.step_by_step = $('#exampleModal2 #step_value').val();
                data_pointobj.value_unit = $('#exampleModal2 #unit').val();
            }
            else if ($('#exampleModal2 #DataType2').attr('name') == 'str')
            {
                data_pointobj.str_maxlen = $('#exampleModal2 #str_maxlen').val();
            }
            else if ($('#exampleModal2 #DataType2').attr('name') == 'bool')
            {
                data_pointobj.true_value_name = $('#exampleModal2 #true_name').val();
                data_pointobj.true_value_show = $('#exampleModal2 #true_show_name').val();
                data_pointobj.true_bool_value = 1;
                data_pointobj.false_value_name = $('#exampleModal2 #false_name').val();
                data_pointobj.false_value_show = $('#exampleModal2 #false_show_name').val();
                data_pointobj.false_bool_value = 0;
            } 
            else
            {
                //枚举
            }    
            $.ajax({
                url:"../../product_development_specific/"+model_name+'/'+data_pointobj.model_select_uri,
                type:"POST",
                timeout:3000,
                contextType:"application/json;charset=utf-8",
                data:JSON.stringify(data_pointobj),//data 为字典格式
                dataType:"json",
                async:true,
                headers:{"X-CSRFToken":$('[name="csrfmiddlewaretoken"]').val()},
                success:function(arg){
                    console.log(arg);
                    if(arg['success']=='success')
                    {
                        alert('保存成功');
                    }
                    window.location.href=".";
                },
                error:function(XMLHttpRequest,textStatus,errorThrown){
                    console.log(textStatus);
                },
            }); 
            return false;   
        });
    })
</script>
{% endblock %}
